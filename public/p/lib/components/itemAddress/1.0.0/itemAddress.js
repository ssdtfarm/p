define(function(require,exports,module){function itemAddress(config){function doCallback(fun,obj){return fun(obj)}function setLabel(){var value="";$(".JQ_navItem").each(function(){var itemVal=$(this).find("span").html();value+=itemVal}),$("#J_label").html(value)}function loadPro(obj){var proHtml="";$.ajax({url:"http://api.kinhom.com/region/pro",dataType:"jsonp",success:function(res){for(var i=0;len=res.length,i<len;i++)proHtml+="<li>",proHtml+='<a href="javascript:void(0)" data-id="'+res[i].region_id+'" parent-id="'+res[i].parent_id+'">'+res[i].region_name+"</a>",proHtml+="</li>";obj.html(proHtml)}})}function loadCity(obj,parentID){var cityHtml="";$.ajax({url:"http://api.kinhom.com/region/city/"+parentID,dataType:"jsonp",success:function(res){for(var i=0;len=res.length,i<len;i++)cityHtml+="<li>",cityHtml+='<a href="javascript:void(0)" data-id="'+res[i].region_id+'" parent-id="'+res[i].parent_id+'">'+res[i].region_name+"</a>",cityHtml+="</li>";obj.html(cityHtml)}})}function loadArea(obj,parentID){var areaHtml="";$.ajax({url:"http://api.kinhom.com/region/area/"+parentID,dataType:"jsonp",success:function(res){for(var i=0;len=res.length,i<len;i++)areaHtml+="<li>",areaHtml+='<a href="javascript:void(0)" data-id="'+res[i].region_id+'" parent-id="'+res[i].parent_id+'">'+res[i].region_name+"</a>",areaHtml+="</li>";obj.html(areaHtml)}})}var config=config||{},tplData={defaultPro:config.defaultPro||"广东省",defaultCity:config.defaultCity||"广州市",defaultArea:config.defaultArea||"天河区",defaultProID:config.defaultProID||44e4,defaultCityID:config.defaultCityID||440100,defaultAreaID:config.defaultAreaID||440106},tpl=config.tpl||null,tplName=config.tplName||null,proCallback=config.proCallback||function(){},cityCallback=config.cityCallback||function(){},areaCallback=config.areaCallback||function(){},flag=!1,mainCell="string"==typeof config.dom?config.dom.indexOf("#")>-1?$(config.dom):$("#"+config.dom):config.dom;mainCell.html(tpl(tplName,tplData));var labelObj=mainCell.find("#J_addressLabel"),selector=mainCell.find("#J_selector"),proContainer=(mainCell.find("#J_selectorNav"),$(".JQ_selectorItem_0")),cityContainer=$(".JQ_selectorItem_1"),areaContainer=$(".JQ_selectorItem_2");loadPro(proContainer),loadCity(cityContainer,tplData.defaultProID),loadArea(areaContainer,tplData.defaultCityID),labelObj.on("click",function(event){event.preventDefault(),$(this).addClass("hover"),selector.show()}),$(document).on("click","#J_close",function(event){event.preventDefault(),labelObj.removeClass("hover"),selector.hide()}),$(".JQ_navItem").each(function(index){var ind=index,that=$(this);that.on("click",function(event){event.preventDefault(),that.hasClass("on")||(that.addClass("on").siblings("a").removeClass("on"),$(".JQ_selectorItem_"+ind).show().siblings("ul").hide())})}),$(document).on("click",".JQ_selectorItem_0 a",function(event){var pID=$(this).attr("data-id"),pName=$(this).html();event.preventDefault(),$(".JQ_navItem").eq(1).addClass("on").show().siblings().removeClass("on"),$(".JQ_pro").html(pName).attr("data-id",pID),$(".JQ_city").html("请选择"),cityContainer.html('<div class="loading"><i></i></div>'),proContainer.hide(),cityContainer.show(),areaContainer.hide(),loadCity(cityContainer,pID),$(".JQ_navItem").eq(2).html('<span class="JQ_area" data-id="">请选择</span><i class="icon-select-down-small"></i>').addClass("on").hide(),areaContainer.html('<div class="loading"><i></i></div>'),doCallback(proCallback,$(this))}),$(document).on("click",".JQ_selectorItem_1 a",function(event){event.preventDefault();var ID=$(this).attr("data-id"),pName=$(this).html();$(".JQ_city").attr("data-id",ID).html(pName),$(".JQ_navItem").eq(1).removeClass("on"),$(".JQ_navItem").eq(2).show().addClass("on").html('<span class="JQ_area" data-id="">请选择</span><i class="icon-select-down-small"></i>'),proContainer.hide(),cityContainer.hide(),areaContainer.show(),areaContainer.html('<div class="loading"><i></i></div>'),loadArea(areaContainer,ID),doCallback(cityCallback,$(this))}),$(document).on("click",".JQ_selectorItem_2 a",function(event){event.preventDefault(),flag=!0;var ID=$(this).attr("data-id"),pName=$(this).html();$(".JQ_area").attr("data-id",ID).html(pName),selector.hide(),labelObj.removeClass("hover"),setLabel(),doCallback(areaCallback,$(this))})}module.exports=itemAddress});