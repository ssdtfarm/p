/*! kinhom 2014-12-01 */
function cashBackInit(){loginStatus.login?($("#J_noLoginCopy,#J_noLoginMail,#J_noLoginTip").hide(),$("#J_invitaTable,#J_invitaPage").show(),loginStatus.hasBankInfo?$("#J_modifyBankInfo").show():$("#J_fillBankInfo").show(),copyToClipboard("J_copyButton"),setShareOtherUrl(),$("#J_vilateCode").click(function(){$(this).attr("src","http://www.kinhom.com/index.php?act=seccode&op=makecode&nchash=6b37c536")}),$("input.JQ_mailInput").each(function(){var a=$(this).attr("data-init");$(this).focus(function(){$.trim($(this).val())===a&&$(this).val("")}),$(this).blur(function(){""==$.trim($(this).val())&&$(this).val(a)})}),$("#J_LoginMail").click(function(){chkMail("J_shareMail")&&chkCode("J_shareVaCode")&&$.getJSON("http://test.kinhom.com/branches/fronend_V27_linyandi/linyandi/pc-new/modules/cash_back/sendMail.php",function(a){"succ"==a.status?msgDialog({width:400,height:200,content:'<div class="cb-share-tip"><span class="icon-ok"></span>邮件已发送成功！</div>'},function(){msgDialog.closeAll()}):msgDialog({width:400,height:200,content:'<div class="cb-share-tip"><span class="icon-no"></span>邮件发送失败，请重试.</div>'},function(){msgDialog.closeAll()})})})):($("#J_fillBankInfo,#J_noInvitaTable").show(),$("#J_shareMail,#J_shareVaCode").attr("readonly",!0))}function chkMail(a){var b=$("#"+a).val();if(""==$.trim(b)||"请输入好友邮箱地址"==$.trim(b))return $("#J_inputMailTip").html("<span></span>请输入邮箱地址!"),!1;var c=/^[a-z\d]+(\.[a-z\d]+)*@([\da-z](-[\da-z])?)+(\.{1,2}[a-z]+)+$/;return c.test(b)?($("#J_inputMailTip").html(""),!0):($("#J_inputMailTip").html("<span></span>邮箱格式错误!"),!1)}function chkCode(a){var b=$("#"+a).val();return""==$.trim(b)||"请输入验证码"==$.trim(b)?($("#J_inputCodeTip").html("<span></span>请输入验证码!"),!1):$.getJSON("http://test.kinhom.com/branches/fronend_V27_linyandi/linyandi/pc-new/modules/cash_back/test.php",function(a){return"succ"==a.status?($("#J_inputCodeTip").html(""),!0):($("#J_inputCodeTip").html("<span></span>验证码输入错误!"),!1)})}function copyToClipboard(a){var b=new ZeroClipboard(document.getElementById(a),{moviePath:"js/ZeroClipboard.swf"});b.on("load",function(a){a.on("complete",function(){msgDialog({width:400,height:260,content:'<div class="cb-share-tip"><span class="icon-ok"></span>复制成功！</div><div class="cb-share-content">您可在QQ群、QQ好友、微博、微信、论坛等处进行分享，分享后即可获得返现成交金额的5%.<div>'},function(){msgDialog.closeAll()})})})}function setShareOtherUrl(){var a=$("input#J_shareLink").val(),b=$("#J_shareLinkContent").html();$(".JQ_shareOther").each(function(){var c=parseInt($(this).attr("data-for"));switch(c){case 0:shareUrl="http://connect.qq.com/widget/shareqq/index.html?title=返现赚钱&url="+a+"&desc="+b,$(this).find("a").attr("href",shareUrl);break;case 1:shareUrl="http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url="+a+"&desc="+b,$(this).find("a").attr("href",shareUrl);break;case 2:shareUrl="http://v.t.sina.com.cn/share/share.php?url="+a+"&title="+b,$(this).find("a").attr("href",shareUrl);break;case 3:shareUrl="http://v.t.qq.com/share/share.php?url="+a+"&title="+b,$(this).find("a").attr("href",shareUrl);break;case 4:shareUrl="http://share.renren.com/share/buttonshare.do?link="+a+"&title="+b,$(this).find("a").attr("href",shareUrl);break;case 5:shareUrl="http://t.163.com/article/user/checkLogin.do?link="+a+"&title="+b,$(this).find("a").attr("href",shareUrl);break;case 6:shareUrl="http://www.douban.com/recommend/?url="+a+"&title="+b,$(this).find("a").attr("href",shareUrl)}})}function fillBankInfo(){for(var a=0;a<bankNameData.length;a++)$("#J_fillBankList").append('<li id="'+bankNameData[a].bankId+'" class="fill-bank-item JQ_bankItem">'+bankNameData[a].bankName+"<li>");$(document).on("click","#J_showBankList",function(){$("ul#J_fillBankList").slideToggle()}),$("li.JQ_bankItem").each(function(){$(this).click(function(){$("ul#J_fillBankList").slideUp(),$("div#J_bankChecked").html($(this).html()),$("input[name=fillBankname]").val($(this).attr("id"))})}),$(document).on("click","#J_passFillBank",function(){msgDialog.closeAll()}),$("input.JQ_fillInput").each(function(){var a=$(this).attr("data-init");$(this).focus(function(){$(this).val()==a&&$(this).val("")}).blur(function(){""==$.trim($(this).val())&&$(this).val(a)})})}function chkFillBankName(a){var b=$("input[name="+a+"]");return b.val()==b.attr("data-init")||""==$.trim(b.val())?($("span#J_fillTipName").html("姓名不能为空"),!1):isChineseChar(b.val())?($("span#J_fillTipName").html(""),!0):($("span#J_fillTipName").html("姓名只能是中文"),!1)}function chkFillBankPhone(a){var b=$("input[name="+a+"]"),c=/^(13[0-9]|15[0-9]|17[0-9]|18[0-9])\d{8}$/;return $.trim(b.val())==b.attr("data-init")||""==$.trim(b.val())?($("span#J_fillTipPhone").html("手机号码不能为空"),!1):c.test($.trim(b.val()))?($("span#J_fillTipPhone").html(""),!0):($("span#J_fillTipPhone").html("手机号码格式有错"),!1)}function chkAlipay(a){var b=$("input[name="+a+"]"),c=/^[0-9]{11}|^([a-z0-9_\.-]+)@([\da-z\.-]+)\.([a-z\.]{2,6})$/;return $.trim(b.val())==b.attr("data-init")||""==$.trim(b.val())?($("span#J_fillTipAlipay").html("支付宝账号不能为空"),$("span#J_fillTipCartId").html(""),!1):c.test($.trim(b.val()))?($("span#J_fillTipAlipay").html(""),$("span#J_fillTipCartId").html(""),!0):($("span#J_fillTipAlipay").html("支付宝账号格式有错"),$("span#J_fillTipCartId").html(""),!1)}function chkCartId(a){var b=$("input[name="+a+"]"),c=/^[0-9]{19,23}$/;return $.trim(b.val())==b.attr("data-init")||""==$.trim(b.val())?($("span#J_fillTipCartId").html("银行卡号不能为空"),$("span#J_fillTipAlipay").html(""),!1):""!=$.trim($("input[name=fillBankname]").val())&&"undefined"!=$.trim($("input[name=fillBankname]").val())?c.test($.trim(b.val()))?($("span#J_fillTipCartId,span#J_fillTipAlipay,span#J_fillTipBank").html(""),!0):($("span#J_fillTipCartId").html("银行卡号格式有错"),$("span#J_fillTipAlipay,span#J_fillTipBank").html(""),!1):($("span#J_fillTipBank").html("请选择银行"),!1)}function isChineseChar(a){var b=/[\u4E00-\u9FA5\uF900-\uFA2D]/;return b.test(a)}function plusToNumber(a,b){var a=a||{},c=a.dom||null,d=a.speed||1e3,e=a.tarNum||3e3,b=b||null,f=$(c),g=f.html(),h=0,i=0;h=parseInt(e/d),i=10*h;var j=setInterval(function(){e>g?(g=parseInt(g)+i,f.html(g>=e?e:g)):(k(),clearInterval(j))},1),k=function(){$.isFunction(b)&&b(c)}}var bankNameData=[{bankId:"1",bankName:"工商银行"},{bankId:"2",bankName:"招商银行"},{bankId:"3",bankName:"建设银行"},{bankId:"4",bankName:"农业银行"},{bankId:"5",bankName:"中国银行"},{bankId:"6",bankName:"交通银行"},{bankId:"7",bankName:"农商银行"}];$(function(){plusToNumber({dom:"#J_countNum",tarNum:5500,speed:1e3}),plusToNumber({dom:"#J_countMoney",tarNum:6411254,speed:2e3}),cashBackInit(loginStatus),$("#J_fillBankInfoBtn").click(function(){if(loginStatus.login){var a='<div class="cb-fill-info">';a+='<div class="cb-fill-info-text">请完善您的支付宝或银行卡号信息，以便我们能在第一时间给您返现。</div>',a+='<div class="cb-fill-form"><form action="" method="post">',a+='<div class="cb-fill-info-tr mt10"><input type="text" name="fillName" data-init="请输入您的姓名" value="请输入您的姓名" class="cb-fill-form-input JQ_fillInput" /><span class="cb-fill-info-tip tip-name" id="J_fillTipName"></span></div>',a+='<div class="cb-fill-info-tr mt10"><input type="text" name="fillPhone" data-init="请输入您的手机号码" value="请输入您的手机号码" class="cb-fill-form-input JQ_fillInput" /><span class="cb-fill-info-tip tip-phone" id="J_fillTipPhone"></span></div>',a+='<div class="cb-fill-info-text">以下两个只需填一个即可</div>',a+='<div class="cb-fill-info-tr"><input type="text" name="fillAlipay" data-init="请输入您的支付宝帐号" value="请输入您的支付宝帐号" class="cb-fill-form-input JQ_fillInput" /><span class="cb-fill-info-tip tip-alipay" id="J_fillTipAlipay"></span></div>',a+='<input type="hidden" name="fillBankname" />',a+='<div class="cb-fill-bank-list">',a+='<div class="fill-bank-check" id="J_bankChecked">选择银行</div><span class="fill-bank-icon" id="J_showBankList"></span>',a+='<ul class="fill-bank-item-list" id="J_fillBankList"></ul><span class="cb-fill-info-tip tip-bank" id="J_fillTipBank"></span></div>',a+='<div class="cb-fill-info-tr mt10"><input type="text" name="fillCartId" data-init="请输入您的银行卡号" value="请输入您的银行卡号" class="cb-fill-form-input JQ_fillInput" /><span class="cb-fill-info-tip tip-cartId" id="J_fillTipCartId"></span></div>',a+="</form>",a+="</div></div>",msgDialog({title:"欢迎加入金海马返现",btnOkText:"现在去返现",bottom:'以后再补充，<A href="javasript:void(0);" id="J_passFillBank">跳过</a>',width:400,height:420,content:a},function(){var a=cartIdFlag=!1;chkFillBankName("fillName")&&chkFillBankPhone("fillPhone")&&(""!=$.trim($("input[name=fillAlipay]").val())&&$.trim($("input[name=fillAlipay]").val())!=$("input[name=fillAlipay]").attr("data-init")&&(a=!0),""!=$.trim($("input[name=fillCartId]").val())&&$.trim($("input[name=fillCartId]").val())!=$("input[name=fillCartId]").attr("data-init")&&(cartIdFlag=!0),a||cartIdFlag?($("span#J_fillTipAlipay,span#J_fillTipCartId").html(""),a&&cartIdFlag?chkAlipay("fillAlipay")&&chkCartId("fillCartId"):(a&&chkAlipay("fillAlipay"),cartIdFlag&&chkCartId("fillCartId"))):$("span#J_fillTipAlipay,span#J_fillTipCartId").html("支付宝账号和银行账号必须填写一个"))},null,function(){fillBankInfo()})}else loadLoginDialog()}),$("#J_noLoginBtn,#J_invitaLogin").click(function(){loadLoginDialog()})});